<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IsaacsPOS Customer Login</title>
<style>
/* General */
body { font-family: Arial, sans-serif; background:#f0f2f5; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }

/* Container */
.container { background:white; padding:30px; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,0.1); width:320px; text-align:center; }
h2 { margin-bottom:20px; }
input { width:100%; padding:10px; margin:10px 0; border-radius:6px; border:1px solid #ccc; }
button { width:100%; padding:10px; border:none; border-radius:6px; background:#28a745; color:white; font-weight:bold; cursor:pointer; }
button:hover { background:#218838; }
.message { margin-top:15px; text-align:center; color:red; }

/* Splash screen */
#splash { position:fixed; top:0; left:0; width:100%; height:100%; background:#28a745; color:white; display:flex; justify-content:center; align-items:center; font-size:2em; z-index:999; flex-direction:column; }
</style>
</head>
<body>
<div id="splash">
    <h1>Welcome to IsaacsPOS</h1>
</div>

<div class="container" id="loginContainer" style="display:none;">
    <h2>Customer Login / Signup</h2>
    <input type="text" id="namePhone" placeholder="Name or Phone" required>
    <input type="password" id="password" placeholder="Password" required>
    <button id="loginBtn">Enter</button>
    <div class="message" id="message"></div>
</div>

<script>
// === CONFIGURATION ===
const GITHUB_OWNER = "YourGitHubUsername";
const GITHUB_REPO = "IsaacsPOS";
const GITHUB_PATH = "repo/customers.json";
const GITHUB_TOKEN = "ghp_YOUR_PERSONAL_ACCESS_TOKEN"; // Replace with your PAT

const splash = document.getElementById("splash");
const loginContainer = document.getElementById("loginContainer");
const message = document.getElementById("message");

// === Splash Animation ===
setTimeout(() => {
    splash.style.display = "none";
    loginContainer.style.display = "block";
}, 2000);

// === GitHub API Functions ===
async function fetchCustomers() {
    const url = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${GITHUB_PATH}`;
    const res = await fetch(url, { headers: { Authorization: `token ${GITHUB_TOKEN}` } });
    if (res.status === 404) return { content: [], sha: null }; // file doesn't exist
    if (!res.ok) throw new Error("Failed to fetch customers.json");
    const data = await res.json();
    const content = atob(data.content);
    return { content: JSON.parse(content), sha: data.sha };
}

async function saveCustomers(customers, sha) {
    const url = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${GITHUB_PATH}`;
    const body = {
        message: "Update customers.json",
        content: btoa(JSON.stringify(customers, null, 2)),
        sha: sha
    };
    const res = await fetch(url, {
        method: "PUT",
        headers: { Authorization: `token ${GITHUB_TOKEN}`, "Content-Type": "application/json" },
        body: JSON.stringify(body)
    });
    if (!res.ok) throw new Error("Failed to save customers.json");
}

// === Login / Signup Logic ===
document.getElementById("loginBtn").addEventListener("click", async () => {
    const namePhone = document.getElementById("namePhone").value.trim();
    const password = document.getElementById("password").value.trim();
    message.style.color = "red";

    if (!namePhone || !password) { message.textContent = "All fields required"; return; }

    try {
        let { content: customers, sha } = await fetchCustomers();
        const existing = customers.find(c => c.namePhone === namePhone);

        if (existing) {
            if (existing.password !== password) {
                message.textContent = "Incorrect password";
                return;
            }
            message.style.color = "green";
            message.textContent = "Login successful!";
        } else {
            customers.push({ namePhone, password, created: new Date().toISOString() });
            await saveCustomers(customers, sha);
            message.style.color = "green";
            message.textContent = "Signup successful!";
        }
    } catch (err) {
        console.error(err);
        message.textContent = "Error connecting to GitHub";
    }
});
</script>
</body>
</html>




